(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7337],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return c},kt:function(){return p}});var a=t(67294);function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach(function(n){var a,r;a=e,r=t[n],n in a?Object.defineProperty(a,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):a[n]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var s=a.createContext({}),i=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=i(e.components);return a.createElement(s.Provider,{value:n},e.children)},l={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},u=a.forwardRef(function(e,n){var t=e.components,r=e.mdxType,s=e.originalType,c=e.parentName,u=function(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],!(n.indexOf(t)>=0)&&Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}(e,["components","mdxType","originalType","parentName"]),p=i(t),d=p["".concat(c,".").concat(r)]||p[r]||l[r]||s;return t?a.createElement(d,o(o({ref:n},u),{},{components:t})):a.createElement(d,o({ref:n},u))});function p(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,s=Array(o);s[0]=u;var i={};for(var c in n)hasOwnProperty.call(n,c)&&(i[c]=n[c]);i.originalType=e,i.mdxType="string"==typeof e?e:r,s[1]=i;for(var l=2;l<o;l++)s[l]=t[l];return a.createElement.apply(null,s)}return a.createElement.apply(null,t)}u.displayName="MDXCreateElement"},20747:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/functions",function(){return t(46190)}])},46190:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return M}});var a=t(85893),r=t(41120),o=t(43832),s=t(41749),i=t(22318),c=t(18463),l=t(79912),u=t(87462),p=t(45987),d=t(67294);t(45697);var m=t(86010),f=t(93871),g=t(1591),h=t(24896),b=t(17294),y=d.forwardRef(function(e,n){var t=e.classes,a=e.className,r=e.color,o=e.component,s=void 0===o?"a":o,c=e.onBlur,l=e.onFocus,g=e.TypographyClasses,y=e.underline,x=e.variant,j=(0,p.Z)(e,["classes","className","color","component","onBlur","onFocus","TypographyClasses","underline","variant"]),k=(0,h.Z)(),v=k.isFocusVisible,N=k.onBlurVisible,O=k.ref,Z=d.useState(!1),w=Z[0],C=Z[1],T=(0,b.Z)(n,O);return d.createElement(i.Z,(0,u.Z)({className:(0,m.Z)(t.root,t["underline".concat((0,f.Z)(void 0===y?"hover":y))],a,w&&t.focusVisible,"button"===s&&t.button),classes:g,color:void 0===r?"primary":r,component:s,onBlur:function(e){w&&(N(),C(!1)),c&&c(e)},onFocus:function(e){v(e)&&C(!0),l&&l(e)},ref:T,variant:void 0===x?"inherit":x},j))}),x=(0,g.Z)({root:{},underlineNone:{textDecoration:"none"},underlineHover:{textDecoration:"none","&:hover":{textDecoration:"underline"}},underlineAlways:{textDecoration:"underline"},button:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle","-moz-appearance":"none","-webkit-appearance":"none","&::-moz-focus-inner":{borderStyle:"none"},"&$focusVisible":{outline:"auto"}},focusVisible:{}},{name:"MuiLink"})(y),j=t(282),k=t(95477),v=t(45414),N=t(3905);let O={};function Z(e){let{components:n,...t}=e;return(0,N.kt)("wrapper",Object.assign({},O,t,{components:n,mdxType:"MDXLayout"}),(0,N.kt)("p",null,'For example, you can define a lambda called "length" which returns the length of a string:'),(0,N.kt)("div",Object.assign({},{className:"remark-highlight"}),(0,N.kt)("pre",Object.assign({parentName:"div"},{className:"language-ruby"}),(0,N.kt)("code",Object.assign({parentName:"pre"},{className:"language-ruby"}),(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token comment"}),"# Returns the length of the provided string"),"\nlength ",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"=")," lambda ",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"do")," ",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"|"),"str",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token operator"}),"|"),"\n  str",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"length\n",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token keyword"}),"end"),"\n"))),(0,N.kt)("p",null,"Then, call it from a formula field in your schemas:"),(0,N.kt)("div",Object.assign({},{className:"remark-highlight"}),(0,N.kt)("pre",Object.assign({parentName:"div"},{className:"language-ruby"}),(0,N.kt)("code",Object.assign({parentName:"pre"},{className:"language-ruby"}),"length",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"call",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"first_name",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n"))),(0,N.kt)("p",null,"Or from any inline formula:"),(0,N.kt)("div",Object.assign({},{className:"remark-highlight"}),(0,N.kt)("pre",Object.assign({parentName:"div"},{className:"language-ruby"}),(0,N.kt)("code",Object.assign({parentName:"pre"},{className:"language-ruby"}),"length",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),"call",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"this",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n"))),(0,N.kt)("p",null,"You can also use the shorthand for calling lambdas:"),(0,N.kt)("div",Object.assign({},{className:"remark-highlight"}),(0,N.kt)("pre",Object.assign({parentName:"div"},{className:"language-ruby"}),(0,N.kt)("code",Object.assign({parentName:"pre"},{className:"language-ruby"}),"length",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"."),(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),"("),"this",(0,N.kt)("span",Object.assign({parentName:"code"},{className:"token punctuation"}),")"),"\n"))))}Z.isMDXComponent=!0;var w=t(9008),C=t.n(w),T=t(77912),E=t(68794),S=t(69947),P=t(74665),R=t(73727),D=t(92122);let _=(0,r.Z)(e=>({root:{marginTop:e.spacing(4)},main:{display:"flex"},editor:{"& .CodeMirror":{height:"100%"}},help:{flex:1,padding:e.spacing(0,2),marginTop:e.spacing(-2),...e.typography.body1},left:{flex:2,display:"flex",flexDirection:"column",gap:e.spacing(2),height:"calc(100vh - 290px)","& *:last-child":{flex:1}}})),F="\n# Example:\n#\n# length = lambda do |str|\n#  str.length\n# end\n".trimStart();function M(){let e=_(),n=(0,d.useRef)(),[t,r]=(0,d.useState)(F),[u,p]=(0,d.useState)(0),[m,f]=(0,d.useState)(!1),{session:g}=(0,d.useContext)(D.Z),h=(0,d.useCallback)(async(e,n)=>{let{resetForm:t,setErrors:a}=n;if(g.user){let n=await fetch("/rest/functions",{method:"PATCH",body:JSON.stringify({functions:e.functions}),headers:{"Content-Type":"application/json"}});n.ok?(t(),(0,P.Z)("Changes saved.")):a({functions:(await n.json()).error})}},[g]),{values:b,setFieldValue:y,dirty:N,isSubmitting:O,handleSubmit:w,resetForm:M,errors:A}=(0,E.TA)({initialValues:{functions:t},onSubmit:h,enableReinitialize:!0}),B=(0,d.useCallback)(()=>{p(e=>e+1)},[]),I=(0,d.useCallback)(e=>{y("functions",e)},[]),V=(0,d.useCallback)(async()=>{await (0,S.Z)({message:"Are you sure you want to revert your changes?",confirmButtonText:"Revert Changes"})&&(await y("functions",t),M(),B())},[t,y]);return((0,d.useEffect)(()=>{(async function(){let e=await fetch("/rest/functions");if(e.ok){let{functions:n}=await e.json(),t=null==n?F:n;r(t),y("functions",t),console.log("reset to",t)}f(!0)})()},[]),m)?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(C(),{children:(0,a.jsx)("link",{rel:"stylesheet",href:"https://unpkg.com/dracula-prism/dist/css/dracula-prism.css"})}),(0,a.jsxs)(o.Z,{maxWidth:"xl",className:e.root,children:[(0,a.jsxs)(s.Z,{container:!0,spacing:3,children:[(0,a.jsx)(s.Z,{item:!0,xs:12,children:(0,a.jsx)(i.Z,{variant:"h1",children:"My Functions"})}),(0,a.jsx)(s.Z,{item:!0,xs:12,children:(0,a.jsx)(c.Z,{variant:"outlined",children:(0,a.jsx)(l.Z,{children:(0,a.jsx)(i.Z,{variant:"body2",component:"div",children:(0,a.jsx)("p",{style:{marginTop:0,marginBottom:0},children:"Here you can define Ruby lambda functions that you can reference in any formula."})})})})}),!g.user&&(0,a.jsx)(s.Z,{item:!0,xs:12,children:(0,a.jsx)(x,{href:"/sign-up?afterSignIn=".concat(encodeURIComponent("/functions")),passHref:!0,children:(0,a.jsx)(j.Z,{variant:"contained",color:"primary",children:"Sign up for a free account to get started"})})}),g.user&&(0,a.jsxs)(s.Z,{item:!0,xs:12,className:e.main,children:[(0,a.jsxs)("div",{className:e.left,children:[A.functions&&(0,a.jsx)(c.Z,{variant:"outlined",children:(0,a.jsxs)(l.Z,{children:[(0,a.jsx)(i.Z,{color:"error",variant:"body2",component:"span",children:(0,a.jsx)("b",{children:"Error: "})}),(0,a.jsx)(i.Z,{variant:"body2",component:"span",children:A.functions})]})}),(0,a.jsx)(v.Z,{name:"functions",value:b.functions,onChange:I,autoFocus:!0,ref:n,classes:{root:e.editor}},u)]}),(0,a.jsx)("div",{className:e.help,children:(0,a.jsx)(Z,{})})]})]}),(0,a.jsxs)(T.Z,{visible:N,children:[(0,a.jsx)(j.Z,{variant:"outlined",disabled:!N||O,onClick:V,children:"Revert"}),(0,a.jsx)(j.Z,{variant:"contained",color:"primary",disabled:!N||O,onClick:w,startIcon:O&&(0,a.jsx)(k.Z,{size:16,color:"inherit"}),children:O?"Saving...":"Save Changes"})]})]})]}):(0,a.jsx)(R.Z,{})}},73727:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var a=t(85893),r=t(95477);function o(){return(0,a.jsx)("div",{style:{height:"calc(100vh - 64px)",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",position:"absolute",top:64,left:0,right:0},children:(0,a.jsx)(r.Z,{})})}},77912:function(e,n,t){"use strict";t.d(n,{Z:function(){return p}});var a=t(85893),r=t(41120),o=t(59693),s=t(79895),i=t(86010),c=t(45697),l=t.n(c);let u=(0,r.Z)(e=>({root:{position:"fixed",zIndex:10,bottom:0,left:0,padding:e.spacing(1),color:e.palette.secondary.contrastText,width:"100vw",top:"unset",display:"flex",justifyContent:"center",background:(0,o.U1)(e.palette.secondary.dark,.95),borderRadius:0,gap:e.spacing(1),boxShadow:"0px -10px 10px -1px rgba(0,0,0,0.2),0px 5px 8px 0px rgba(0,0,0,0.14),0px 1px 14px 0px rgba(0,0,0,0.12)",transform:"translateY(50px)",transition:"transform 150ms ease-in"},visible:{transform:"translateY(0)"}}));function p(e){let{visible:n,children:t}=e,r=u();return(0,a.jsx)(s.Z,{elevation:5,className:(0,i.Z)({[r.root]:!0,[r.visible]:n}),children:t})}p.propTypes={visible:l().bool.isRequired},p.defaultProps={visible:!0}},45414:function(e,n,t){"use strict";var a=t(85893),r=t(67294),o=t(84813),s=t.n(o),i=t(86010),c=t(41120),l=t(8920),u=t(35442);let p=(0,c.Z)(e=>({root:{width:"100%",maxWidth:"100%","& .CodeMirror":{borderRadius:3,fontFamily:e.typography.codeFont,padding:e.spacing(1,1),borderStyle:"solid",borderWidth:1,borderColor:e.palette.divider,height:488,"& *::selection":{background:"white",color:"red"}},"body & div.CodeMirror-selected":{background:"".concat(u.Z[700]," !important"),borderRadius:3}},readOnly:{"& .CodeMirror":{backgroundColor:"transparent !important"}},single:{"& .CodeMirror":{height:46}}}));n.Z=(0,r.forwardRef)(function(e,n){let{autoFocus:o,name:c,value:u,autoFormat:d,readOnly:m,onChange:f,single:g,classes:h,...b}=e,y=(0,l.Z)();h=p({classes:h});let[x,j]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{t(91380),t(57034),t(80853),j(!0)},[]),d&&(u=u.replace(/(\n)*[ ]*\|\s?/g,"$1").trim()),b.options||(b.options={}),b.options.readOnly=m,x?(0,a.jsx)(s(),{autoFocus:o,ref:n,mode:"ruby",className:(0,i.Z)({[h.root]:!0,[h.single]:g,[h.readOnly]:m}),value:u,onChange:f,...b,options:{...b.options,readOnly:m,theme:"dark"===y.palette.type?"railscasts":"default"}}):null})}},function(e){e.O(0,[3126,2683,5718,9774,2888,179],function(){return e(e.s=20747)}),_N_E=e.O()}]);